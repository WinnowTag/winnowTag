<div class="section" id="show_sort_section">
  <div class="content">
    <div class="choice_filter">
      <%= _(:show_label) %>
      <%= link_to_function _(:show_all_label), "itemBrowser.addFilters({mode: 'all'})", :id => "mode_all" %>, 
      <%= link_to_function _(:show_unread_label), "itemBrowser.addFilters({mode: 'unread'})", :id => "mode_unread" %>, 
      <%= link_to_function _(:show_moderated_label), "itemBrowser.addFilters({mode: 'moderated'})", :id => "mode_moderated" %>
    </div>

    <div class="choice_filter order">
      <%= _(:sort_label) %>
      <%= link_to_function _(:sort_date_label), "itemBrowser.setOrder('date')", :id => "order_date" %>, 
      <%= link_to_function _(:sort_strength_label), "itemBrowser.setOrder('strength')", :id => "order_strength" %>
    </div>
  </div>
</div>

<div class="section<%= open_tags? ? " open" : "" %>" id="tags_section">
  <div class="header clearfix">
    <span class="toggle_button" onclick="$(this).up('.section').toggleClassName('open'); Cookie.set('tags', $(this).up('.section').hasClassName('open'), 365);"></span>
    <%= link_to_function _(:sidebar_tags_header), "itemBrowser.toggleSetFilters({folder_ids: 'tags'}, event); event.stop()", :id => "tag_filters_control", :class => "name" %>
    
    <div class="actions clearfix">
      <%= link_to_function _(:sidebar_add_tag_link), "$(this).up('.section').addClassName('add'); $('tag_name').focus(); event.stop();", :class => "add_link" %>
      <%= link_to_function _(:sidebar_cancel_add_tag_link), "$(this).up('.section').removeClassName('add'); event.stop();", :class => "cancel_link" %>
    </div>
  </div>

  <div class="add_form">
    <%= text_field_with_auto_complete(:tag, :name, { :class => "filter_search" }, 
          :skip_style => true, :param_name => 'tag[name]', :url => auto_complete_for_sidebar_tags_path,
          :after_update_element => "function(e, v) { update_tag_filters(e,v); $('tags_section').removeClassName('add'); $('tags_section').addClassName('open'); }", :on_hide => "clear_auto_complete") %>
  </div>
  
  <div class="content">
    <%= tag_filter_controls(tags_for_sidebar, :editable => true, :draggable => true, :remove => :subscription, :ul_options => { :id => "tag_filters", :class => "filter_list tags" }) %>
  </div>
</div>
  
<div class="section<%= open_feeds? ? " open" : "" %>" id="feeds_section">
  <div class="header clearfix">
    <span class="toggle_button" onclick="$(this).up('.section').toggleClassName('open'); Cookie.set('feeds', $(this).up('.section').hasClassName('open'), 365);"></span>        
    <%= link_to_function _(:sidebar_feeds_header), "itemBrowser.toggleSetFilters({folder_ids: 'feeds'}, event); event.stop()", :class => "name" %>

    <div class="actions clearfix">
      <%= link_to_function _(:sidebar_add_feed_link), "$(this).up('.section').addClassName('add'); $('feed_title').focus(); event.stop();", :class => "add_link" %>
      <%= link_to_function _(:sidebar_cancel_add_feed_link), "$(this).up('.section').removeClassName('add'); event.stop();", :class => "cancel_link" %>
    </div>
  </div>

  <div class="add_form">
    <%= text_field_with_auto_complete(:feed, :title, { :class => "filter_search" }, 
          :skip_style => true, :param_name => 'feed[title]', :url => auto_complete_for_feed_title_feeds_path,
          :after_update_element => "function(e, v) { update_feed_filters(e,v); $('feeds_section').removeClassName('add'); $('feeds_section').addClassName('open'); }", :on_hide => "clear_auto_complete") %>
  </div>

  <div class="content">
    <%= feed_filter_controls(feeds_for_sidebar, :draggable => true, :remove => :subscription, :ul_options => { :id => "feed_filters", :class => "filter_list feeds" }) %>
  </div>
</div>
    
<div class="section<%= open_folders? ? " open" : "" %>" id="folders_section">
  <div class="header clearfix">
    <span class="toggle_button" onclick="$(this).up('.section').toggleClassName('open'); Cookie.set('folders', $(this).up('.section').hasClassName('open'), 365);"></span>        
    <%= content_tag :span, _(:sidebar_folders_header), :class => "name" %>

    <div class="actions clearfix">
      <%= link_to_function _(:sidebar_add_folder_link), "$(this).up('.section').addClassName('add'); $('folder_name').focus();", :class => "add_link" %>
      <%= link_to_function _(:sidebar_cancel_add_folder_link), "$(this).up('.section').removeClassName('add');", :class => "cancel_link" %>
    </div>
  </div>

  <div id="add_folder" class="add_form">
    <% remote_form_for :folder, :url => folders_path, :method => :post, :after => "$('folders_section').removeClassName('add'); $('folder_name').value = ''" do |form| -%>
      <%= form.text_field :name, :class => "filter_search" %>
    <% end -%>
  </div>

  <div class="content" id="folders">
    <%= render :partial => "feed_items/folder", :collection => current_user.folders %>
  </div>
  <%= sortable_element("folders", :url => sort_folders_path, :method => :put, :constraint => :vertical, :tag => :div, :handle => ".header") %>
</div>

<div class="section" id="clear_section">
  <div class="content">
    <%= button_to_function "", "itemBrowser.setFilters({text_filter: ''})", :id => "clear_selected_filters" %><br>
  </div>
</div>

<div class="section" id="feed_link_section">
  <div class="content">
    <%= link_to _(:feed_for_selected_filters_link), "", :base_url => formatted_feed_items_path(:atom), :class => "feed_icon", :id => "feed_with_selected_filters" %>
  </div>
</div>
